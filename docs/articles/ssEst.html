<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="BayesMassBal">
<title>ssEst â€¢ BayesMassBal</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ssEst">
<meta property="og:description" content="BayesMassBal">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">BayesMassBal</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Two_Node_Process.html">Two_Node_Process</a>
    <a class="dropdown-item" href="../articles/ssEst.html">ssEst</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/skoermer/BayesMassBal/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>ssEst</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/skoermer/BayesMassBal/blob/HEAD/vignettes/ssEst.Rmd" class="external-link"><code>vignettes/ssEst.Rmd</code></a></small>
      <div class="d-none name"><code>ssEst.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/skoermer/BayesMassBal" class="external-link">BayesMassBal</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></code></pre></div>
<p><img src="ssEst_files/figure-html/datagen-1.png" width="700"></p>
<p>When looking over mass flow rate data from the individual stream of a
process, such as the simulated data above, it is often unclear when the
process achieved steady state as well as what the steady state mass flow
rate is. Multiple engineers, each using different tools and reasoning,
looking at this data will have different determinations. Inconsistencies
in estimation can result in misleading conclusions when making process
performance. Thus, there is a need to for a method consistently
categorizing such data.</p>
<p>The <code>ssEst</code> function fills this gap, as well as provides
quantitative information on if the stream is at steady state in the
first place. The below auto-regressive model, with a lag of 1, is fit to
the data.</p>
<p><span class="math display">\[
y_t = \mu + \alpha y_{t-1} + \epsilon
\]</span></p>
<p>Where <span class="math inline">\(\epsilon \sim
\mathcal{N}(0,\sigma^2)\)</span>. Using Bayesian inference,
<code>ssEst</code> function generates samples from the distribution of
the model parameters <span class="math inline">\(\mu\)</span>, <span class="math inline">\(\alpha\)</span>, and <span class="math inline">\(\sigma^2\)</span>. If <span class="math inline">\(|\alpha| &lt; 1\)</span> the model is considered
stationary or mean reverting. The behavior is predictable. It is
possible to calculate <span class="math inline">\(\mathbb{E}\lbrack
y\rbrack\)</span> by the following equation:</p>
<p><span class="math display">\[
\mathbb{E}\lbrack y \rbrack = \frac{\mu}{1-\phi}
\]</span></p>
<p>Getting started, the data set above was generated with the following
code:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, times <span class="op">=</span> <span class="fl">41</span><span class="op">)</span>
<span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">10</span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">20</span>
<span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.8</span>
<span class="va">sig</span> <span class="op">&lt;-</span> <span class="fl">10</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="va">y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">mu</span> <span class="op">+</span> <span class="va">alpha</span> <span class="op">*</span> <span class="va">y</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">sig</span>
<span class="op">}</span></code></pre></div>
<p>Note, <span class="math inline">\(\alpha = 0.8\)</span> implies the
process is stationary. Then the <code>ssEst</code> function is used on
these observed values.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ssEst.html">ssEst</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></code></pre></div>
<p>Since <code>fit1</code> is a <code>"BayesMassBal"</code> object, it
can easily be passed to <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> so the output can be quickly
inspected.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></code></pre></div>
<p><img src="ssEst_files/figure-html/plot1-1.png" width="700"></p>
<p>One can see the density obtained from the samples of <span class="math inline">\(\alpha\)</span>. It is up to the engineer to
decide if there is enough evidence to deem the trend stationary. If all
of the samples of <span class="math inline">\(\alpha\)</span> obtained
are in the interval (-1,1), then the distribution for the estimation of
steady state will also be calculated and displayed. In this case, only a
small fraction of the samples of <span class="math inline">\(\alpha\)</span> are outside of the valid range. It
is likely the chain is stationary.</p>
<p>To inspect <span class="math inline">\(\mathbb{E}\lbrack y
\rbrack\)</span> <code>ssEst</code> is rerun with the argument setting
<code>stationary = TRUE</code>. This setting specifies a prior
distribution on <span class="math inline">\(\alpha\)</span> which forces
all samples to be within (-1,1) so that the steady state mass flow rate
can be calculated. Refitting and re-plotting gives:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ssEst.html">ssEst</a></span><span class="op">(</span><span class="va">y</span>, stationary <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></code></pre></div>
<p><img src="ssEst_files/figure-html/ssConst-1.png" width="700"></p>
<p>The point <span class="math inline">\(\mathbb{E}\lbrack y
\rbrack\)</span> can then be used in a classical point mass balance, or
some subset of the data can be used with the <code><a href="../reference/BMB.html">BMB()</a></code>
function. One way to choose the time steady state of the system has been
achieved is using all data points after which the line for the Expected
Steady State has been crossed. Another method would be to use a subset
of samples of <span class="math inline">\(\mathbb{E} \lbrack y | \mu,
\alpha \rbrack\)</span> with the <code>BMB</code> function.</p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Scott Koermer.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
