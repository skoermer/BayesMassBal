<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ssEst â€¢ BayesMassBal</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="ssEst">
<meta property="og:description" content="BayesMassBal">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BayesMassBal</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ssEst.html">ssEst</a>
    </li>
    <li>
      <a href="../articles/Two_Node_Process.html">Two_Node_Process</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/skoermer/BayesMassBal/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ssEst_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>ssEst</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/skoermer/BayesMassBal/blob/master/vignettes/ssEst.Rmd"><code>vignettes/ssEst.Rmd</code></a></small>
      <div class="hidden name"><code>ssEst.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">BayesMassBal</span>)
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">5</span>)</pre></body></html></div>
<p><img src="ssEst_files/figure-html/datagen-1.png" width="700"></p>
<p>When looking over mass flow rate data from the individual stream of a process, such as the simulated data above, it is often unclear when the process achieved steady state as well as what the steady state mass flow rate is. Multiple engineers, each using different tools and reasoning, looking at this data will have different determinations. Inconsistencies in estimation can result in misleading conclusions when making process performance. Thus, there is a need to for a method consistently categorizing such data.</p>
<p>The <code>ssEst</code> function fills this gap, as well as provides quantitative information on if the stream is at steady state in the first place. The below auto-regressive model, with a lag of 1, is fit to the data.</p>
<p><span class="math display">\[
y_t = \mu + \alpha y_{t-1} + \epsilon
\]</span></p>
<p>Where <span class="math inline">\(\epsilon \sim \mathcal{N}(0,\sigma^2)\)</span>. Using Bayesian inference, <code>ssEst</code> function generates samples from the distribution of the model parameters <span class="math inline">\(\mu\)</span>, <span class="math inline">\(\alpha\)</span>, and <span class="math inline">\(\sigma^2\)</span>. If <span class="math inline">\(|\alpha| &lt; 1\)</span> the model is considered stationary or mean reverting. The behavior is predictable. It is possible to calculate <span class="math inline">\(\mathbb{E}\lbrack y\rbrack\)</span> by the following equation:</p>
<p><span class="math display">\[
\mathbb{E}\lbrack y \rbrack = \frac{\mu}{1-\phi}
\]</span></p>
<p>Getting started, the data set above was generated with the following code:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">y</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">NA</span>, <span class="kw">times</span> <span class="kw">=</span> <span class="fl">41</span>)
<span class="no">y</span>[<span class="fl">1</span>] <span class="kw">&lt;-</span> <span class="fl">10</span>
<span class="no">mu</span> <span class="kw">&lt;-</span> <span class="fl">20</span>
<span class="no">alpha</span> <span class="kw">&lt;-</span> <span class="fl">0.8</span>
<span class="no">sig</span> <span class="kw">&lt;-</span> <span class="fl">10</span>

<span class="kw">for</span>(<span class="no">i</span> <span class="kw">in</span> <span class="fl">2</span>:<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">y</span>)){
  <span class="no">y</span>[<span class="no">i</span>] <span class="kw">&lt;-</span> <span class="no">mu</span> + <span class="no">alpha</span> * <span class="no">y</span>[<span class="no">i</span>-<span class="fl">1</span>] + <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">1</span>)*<span class="no">sig</span>
}</pre></body></html></div>
<p>Note, <span class="math inline">\(\alpha = 0.8\)</span> implies the process is stationary. Then the <code>ssEst</code> function is used on these observed values.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">fit1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/ssEst.html">ssEst</a></span>(<span class="no">y</span>)</pre></body></html></div>
<p>Since <code>fit1</code> is a <code>"BayesMassBal"</code> object, it can easily be passed to <code><a href="https://rdrr.io/r/base/plot.html">plot()</a></code> so the output can be quickly inspected.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">fit1</span>)</pre></body></html></div>
<p><img src="ssEst_files/figure-html/plot1-1.png" width="700"></p>
<p>One can see the density obtained from the samples of <span class="math inline">\(\alpha\)</span>. It is up to the engineer to decide if there is enough evidence to deem the trend stationary. If all of the samples of <span class="math inline">\(\alpha\)</span> obtained are in the interval (-1,1), then the distribution for the estimation of steady state will also be calculated and displayed. In this case, only a small fraction of the samples of <span class="math inline">\(\alpha\)</span> are outside of the valid range. It is likely the chain is stationary.</p>
<p>To inspect <span class="math inline">\(\mathbb{E}\lbrack y \rbrack\)</span> <code>ssEst</code> is rerun with the argument setting <code>stationary = TRUE</code>. This setting specifies a prior distribution on <span class="math inline">\(\alpha\)</span> which forces all samples to be within (-1,1) so that the steady state mass flow rate can be calculated. Refitting and re-plotting gives:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">fit2</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/ssEst.html">ssEst</a></span>(<span class="no">y</span>, <span class="kw">stationary</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">fit2</span>)</pre></body></html></div>
<p><img src="ssEst_files/figure-html/ssConst-1.png" width="700"></p>
<p>The point <span class="math inline">\(\mathbb{E}\lbrack y \rbrack\)</span> can then be used in a classical point mass balance, or some subset of the data can be used with the <code><a href="../reference/BMB.html">BMB()</a></code> function. One way to choose the time steady state of the system has been achieved is using all data points after which the line for the Expected Steady State has been crossed. Another method would be to use a subset of samples of <span class="math inline">\(\mathbb{E} \lbrack y | \mu, \alpha \rbrack\)</span> with the <code>BMB</code> function.</p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Scott Koermer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
