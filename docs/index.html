<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bayesian Data Reconciliation of Separation Processes • BayesMassBal</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Bayesian Data Reconciliation of Separation Processes">
<meta property="og:description" content="Bayesian tools that can be used to reconcile, or mass balance, mass flow rate data collected from chemical or particulate separation processes aided by constraints governed by the conservation of mass.
    Functions included in the package aid the user in organizing and constraining data, using MCMC methods to obtain samples from Bayesian models, and in computation of the marginal likelihood of the data, given a particular model, for model selection.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">BayesMassBal</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/Two_Node_Process.html">Two Node Process Example</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/skoermer/BayesMassBal">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<!-- README.md is generated from README.Rmd. Please edit that file -->
<div id="bayesmassbal" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#bayesmassbal" class="anchor"></a>BayesMassBal</h1></div>
<!-- badges: start -->

<p>The goal of BayesMassBal is to allow users to easily conduct Bayesian data reconciliation for a linearly constrained chemical or particulate process at steady state.</p>
<p>Samples taken from a chemical process are always observed with noise. Using data reconsciliation, or mass balance methods, to filter the noise aided by a conscervation of mass constraint is common in chemical engineering and minining engineering applications.</p>
<p>Typically, a mass balance produces point estimates of true mass flow rates. However, using Bayesian methods one can get a better understanding of process uncertainty to aid in decision making. The <code>BayesMassBal</code> package provides functions allowing the user to easily specify conscervation of mass constraints, organize collected data, conduct a Bayesian mass balance using various error structures, and select the best model for their data using Bayes Factors.</p>
<p>The Bayeisn mass balance uses MCMC methods to obtain samples of the constrained masses. A publication detailing these methods is forthcoming.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the released version of BayesMassBal from <a href="https://CRAN.R-project.org">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"BayesMassBal"</span>)</span></code></pre></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>This is a basic example which shows you how to solve a common problem:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(BayesMassBal)</span></code></pre></div>
<p>The function <code>BMB</code> is used with a two node process and simulated data.</p>
<div class="figure">
<img src="../../../R%20Packages/BayesMassBal/BayesMassBal/man/figures/README-multiprocess-1.png" alt="Example two node circuit" width="100%"><p class="caption">
Example two node circuit
</p>
</div>
<p>The constraints around these process nodes are:</p>
<p><span class="math display">\[\begin{align}
y_1 &amp;= y_2 +y_4\\
y_2 &amp;= y_3 +y_5
\end{align}\]</span></p>
<p>Therefore the matrix of constraints, <code>C</code> is:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>C &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="op">-</span><span class="dv">1</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">5</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a>C</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">#&gt;      [,1] [,2] [,3] [,4] [,5]</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">#&gt; [1,]    1   -1    0   -1    0</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">#&gt; [2,]    0    1   -1    0   -1</span></span></code></pre></div>
<p>The <code>constrain.process</code> function in the <code>BayesMassBal</code> package is used to generate an <code>X</code> matrix based on <code>C</code> that will later be used with the <code>BMB</code> function.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>X &lt;-<span class="st"> </span><span class="kw"><a href="reference/constrain.process.html">constrain.process</a></span>(<span class="dt">C =</span> C)</span>
<span id="cb4-2"><a href="#cb4-2"></a>X</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">#&gt; [1,]    1    1    1</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">#&gt; [2,]    1    0    1</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co">#&gt; [3,]    1    0    0</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co">#&gt; [4,]    0    1    0</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">#&gt; [5,]    0    0    1</span></span></code></pre></div>
<p>The previously simulated data is loaded from a <code>.csv</code> file using the <code><a href="reference/massbal.data.html">massbal.data()</a></code> function.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>y &lt;-<span class="st"> </span><span class="kw"><a href="reference/massbal.data.html">massbal.data</a></span>(<span class="dt">file =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.file">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"twonode_example.csv"</span>,</span>
<span id="cb5-2"><a href="#cb5-2"></a>                                  <span class="dt">package =</span> <span class="st">"BayesMassBal"</span>),</span>
<span id="cb5-3"><a href="#cb5-3"></a>                  <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">csv.params =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">sep =</span> <span class="st">";"</span>))</span></code></pre></div>
<p>Then, the <code>BMB</code> function is used to generate the distribution of constrained masses from the data with <code>cov.structure = "indep"</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>indep.samples &lt;-<span class="st"> </span><span class="kw"><a href="reference/BMB.html">BMB</a></span>(<span class="dt">X =</span> X, <span class="dt">y =</span> y, <span class="dt">cov.structure =</span> <span class="st">"indep"</span>, <span class="dt">BTE =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">100</span>,<span class="dv">3000</span>,<span class="dv">1</span>), <span class="dt">lml =</span> <span class="ot">TRUE</span>, <span class="dt">verb =</span> <span class="dv">0</span>)</span></code></pre></div>
<p>The output of <code>BMB</code> is a <code>BayesMassBal</code> object. Special instructions are designated when feeding a <code>BayesMassBal</code> object to the <code><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot()</a></code> function. Adding the argument <code>layout = "dens"</code> and indicating the mass balanced flow rate for CuFeS2 at <span class="math inline">\(y_3\)</span> should be plotted, by using a list supplied to <code>sample.params</code>, the desired distribution can be plotted with the 95% HPDI.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(indep.samples,<span class="dt">sample.params =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">ybal =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">CuFeS2 =</span> <span class="dv">3</span>)),</span>
<span id="cb7-3"><a href="#cb7-3"></a>    <span class="dt">layout =</span> <span class="st">"dens"</span>,<span class="dt">hdi.params =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="fl">0.95</span>))</span></code></pre></div>
<p><img src="../../../R%20Packages/BayesMassBal/BayesMassBal/man/figures/README-feedplot-1.png" width="100%"></p>
<p>It is also possible to generate trace plots to inspect convergence of the Gibbs sampler. Here are trace plots for <span class="math inline">\(\beta\)</span></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(indep.samples,<span class="dt">sample.params =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">beta =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">CuFeS2 =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">gangue =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)),<span class="dt">layout =</span> <span class="st">"trace"</span>,<span class="dt">hdi.params =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="fl">0.95</span>))</span></code></pre></div>
<p><img src="../../../R%20Packages/BayesMassBal/BayesMassBal/man/figures/README-traceplot-1.png" width="100%"></p>
<p>The model with independent variances may not be the best fitting model. Models specifying covariance between sample locations for a single component, and covariance between components at a single location are fit.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>component.samples &lt;-<span class="st"> </span><span class="kw"><a href="reference/BMB.html">BMB</a></span>(<span class="dt">X =</span> X, <span class="dt">y =</span> y, <span class="dt">cov.structure =</span> <span class="st">"component"</span>, <span class="dt">BTE =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">100</span>,<span class="dv">3000</span>,<span class="dv">1</span>), <span class="dt">lml =</span> <span class="ot">TRUE</span>, <span class="dt">verb =</span> <span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>location.samples &lt;-<span class="st"> </span><span class="kw"><a href="reference/BMB.html">BMB</a></span>(<span class="dt">X =</span> X, <span class="dt">y =</span> y, <span class="dt">cov.structure =</span> <span class="st">"location"</span>, <span class="dt">BTE =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">100</span>,<span class="dv">3000</span>,<span class="dv">1</span>), <span class="dt">lml =</span> <span class="ot">TRUE</span>, <span class="dt">verb =</span> <span class="dv">0</span>)</span></code></pre></div>
<p>Computing <span class="math inline">\(\log(\mathrm{Bayes Factor})\)</span> for <span class="math inline">\(BF = p(y|\texttt{indep})/p(y|\texttt{component})\)</span>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>indep.samples<span class="op">$</span>lml <span class="op">-</span><span class="st"> </span>component.samples<span class="op">$</span>lml</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co">#&gt; [1] -138.6866</span></span></code></pre></div>
<p>Then comparing <span class="math inline">\(p(y|\texttt{component})\)</span> to <span class="math inline">\(p(y|\texttt{location})\)</span></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>component.samples<span class="op">$</span>lml <span class="op">-</span><span class="st"> </span>location.samples<span class="op">$</span>lml</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="co">#&gt; [1] 0.8322911</span></span></code></pre></div>
<p>The main effect of a variable independent of the process can be calculated by supplying a function, <code>fn</code> that takes the arguments of mass balanced flow rates <code>ybal</code>, and therandom independent and uniformly distributed variables <code>x</code>. Information can be gained on the main effect of a particular element of <code>x</code>, <code>xj</code>, on <code>fn</code> using the <code>mainEff</code> function. Output from <code>mainEff</code> inlcudes information on the distribution of <span class="math inline">\(E_x\lbrack f(x,y_{\mathrm{bal}})|x_j \rbrack\)</span>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>fn_example &lt;-<span class="st"> </span><span class="cf">function</span>(X,ybal){</span>
<span id="cb13-2"><a href="#cb13-2"></a>      cu.frac &lt;-<span class="st"> </span><span class="fl">63.546</span><span class="op">/</span><span class="fl">183.5</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>      feed.mass &lt;-<span class="st"> </span>ybal<span class="op">$</span>CuFeS2[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>ybal<span class="op">$</span>gangue[<span class="dv">1</span>]</span>
<span id="cb13-4"><a href="#cb13-4"></a>      <span class="co"># Concentrate mass per ton feed</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>      con.mass &lt;-<span class="st"> </span>(ybal<span class="op">$</span>CuFeS2[<span class="dv">3</span>] <span class="op">+</span><span class="st"> </span>ybal<span class="op">$</span>gangue[<span class="dv">3</span>])<span class="op">/</span>feed.mass</span>
<span id="cb13-6"><a href="#cb13-6"></a>      <span class="co"># Copper mass per ton feed</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>      cu.mass &lt;-<span class="st"> </span>(ybal<span class="op">$</span>CuFeS2[<span class="dv">3</span>]<span class="op">*</span>cu.frac)<span class="op">/</span>feed.mass</span>
<span id="cb13-8"><a href="#cb13-8"></a>      gam &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span><span class="op">/</span>feed.mass,cu.mass,<span class="op">-</span>con.mass,<span class="op">-</span>cu.mass,<span class="op">-</span>con.mass)</span>
<span id="cb13-9"><a href="#cb13-9"></a>      f &lt;-<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>gam</span>
<span id="cb13-10"><a href="#cb13-10"></a>      <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(f)</span>
<span id="cb13-11"><a href="#cb13-11"></a>      }</span>
<span id="cb13-12"><a href="#cb13-12"></a></span>
<span id="cb13-13"><a href="#cb13-13"></a>rangex &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">4.00</span> ,<span class="fl">6.25</span>,<span class="dv">1125</span>,<span class="dv">1875</span>,<span class="dv">3880</span>,<span class="dv">9080</span>,<span class="dv">20</span>,<span class="dv">60</span>,<span class="dv">96</span>,<span class="dv">208</span>,<span class="fl">20.0</span>,<span class="fl">62.5</span>),</span>
<span id="cb13-14"><a href="#cb13-14"></a>                   <span class="dt">ncol =</span> <span class="dv">6</span>, <span class="dt">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb13-15"><a href="#cb13-15"></a>mE_example &lt;-<span class="st"> </span><span class="kw"><a href="reference/mainEff.html">mainEff</a></span>(indep.samples, <span class="dt">fn =</span> <span class="st">"fn_example"</span>,<span class="dt">rangex =</span>  rangex,<span class="dt">xj =</span> <span class="dv">3</span>, <span class="dt">N =</span> <span class="dv">25</span>, <span class="dt">res =</span> <span class="dv">25</span>)</span></code></pre></div>
<p>A plot of the output can be made. To get lines that are better connected, change increase <code>N</code> in the <code>mainEff</code> function.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>m.sens&lt;-<span class="st"> </span>mE_example<span class="op">$</span>fn.out[<span class="dv">2</span>,]</span>
<span id="cb14-2"><a href="#cb14-2"></a>hpd.sens &lt;-<span class="st"> </span>mE_example<span class="op">$</span>fn.out[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">3</span>),]</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/row.names">row.names</a></span>(hpd.sens) &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"upper"</span>, <span class="st">"lower"</span>)</span>
<span id="cb14-4"><a href="#cb14-4"></a>g.plot &lt;-<span class="st"> </span>mE_example<span class="op">$</span>g<span class="op">/</span><span class="dv">2000</span></span>
<span id="cb14-5"><a href="#cb14-5"></a></span>
<span id="cb14-6"><a href="#cb14-6"></a>y.lim &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/range">range</a></span>(hpd.sens)</span>
<span id="cb14-7"><a href="#cb14-7"></a></span>
<span id="cb14-8"><a href="#cb14-8"></a>lzero.bound &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply</a></span>(hpd.sens,<span class="dv">1</span>,<span class="cf">function</span>(X){<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(X <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>)})</span>
<span id="cb14-9"><a href="#cb14-9"></a>lzero.mean &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(m.sens <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb14-10"><a href="#cb14-10"></a></span>
<span id="cb14-11"><a href="#cb14-11"></a>main.grid &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/pretty">pretty</a></span>(g.plot)</span>
<span id="cb14-12"><a href="#cb14-12"></a>minor.grid &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/pretty">pretty</a></span>(g.plot,<span class="dv">25</span>)</span>
<span id="cb14-13"><a href="#cb14-13"></a>minor.grid &lt;-<span class="st"> </span>minor.grid[<span class="op">-</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/which">which</a></span>(minor.grid <span class="op">%in%</span><span class="st"> </span>main.grid)]</span>
<span id="cb14-14"><a href="#cb14-14"></a></span>
<span id="cb14-15"><a href="#cb14-15"></a>y.main &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/pretty">pretty</a></span>(hpd.sens)</span>
<span id="cb14-16"><a href="#cb14-16"></a></span>
<span id="cb14-17"><a href="#cb14-17"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mar =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">4.2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb14-18"><a href="#cb14-18"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(g.plot,m.sens, <span class="dt">type =</span> <span class="st">"n"</span>, <span class="dt">xlim =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/range">range</a></span>(g.plot), <span class="dt">ylim =</span> y.lim, <span class="dt">ylab =</span> <span class="st">"Net Revenue ($/ton Feed)"</span>, <span class="dt">xlab=</span>  <span class="st">"Cu Price ($/lb)"</span>)</span>
<span id="cb14-19"><a href="#cb14-19"></a></span>
<span id="cb14-20"><a href="#cb14-20"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">v =</span> main.grid, <span class="dt">lty =</span> <span class="dv">6</span>, <span class="dt">col =</span> <span class="st">"grey"</span>, <span class="dt">lwd =</span> <span class="dv">1</span>)</span>
<span id="cb14-21"><a href="#cb14-21"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">v =</span> minor.grid, <span class="dt">lty =</span><span class="dv">3</span>, <span class="dt">col =</span> <span class="st">"grey"</span>, <span class="dt">lwd =</span> <span class="fl">0.75</span>)</span>
<span id="cb14-22"><a href="#cb14-22"></a></span>
<span id="cb14-23"><a href="#cb14-23"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/abline">abline</a></span>(<span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">"red"</span>, <span class="dt">lwd =</span> <span class="dv">1</span>, <span class="dt">lty =</span> <span class="dv">6</span>)</span>
<span id="cb14-24"><a href="#cb14-24"></a></span>
<span id="cb14-25"><a href="#cb14-25"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(g.plot[lzero.mean],m.sens[lzero.mean],<span class="dt">col =</span> <span class="st">"red"</span>, <span class="dt">lwd =</span><span class="dv">2</span>)</span>
<span id="cb14-26"><a href="#cb14-26"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(g.plot[<span class="op">-</span>lzero.mean[<span class="op">-</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(lzero.mean)]],m.sens[<span class="op">-</span>lzero.mean[<span class="op">-</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(lzero.mean)]],<span class="dt">col =</span> <span class="st">"darkgreen"</span>, <span class="dt">lwd =</span><span class="dv">2</span>)</span>
<span id="cb14-27"><a href="#cb14-27"></a></span>
<span id="cb14-28"><a href="#cb14-28"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(g.plot[lzero.bound<span class="op">$</span>lower],hpd.sens[<span class="dv">2</span>,][lzero.bound<span class="op">$</span>lower], <span class="dt">lty =</span> <span class="dv">5</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">"red"</span>)</span>
<span id="cb14-29"><a href="#cb14-29"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(g.plot[<span class="op">-</span>lzero.bound<span class="op">$</span>lower],hpd.sens[<span class="dv">2</span>,][<span class="op">-</span>lzero.bound<span class="op">$</span>lower], <span class="dt">lty =</span> <span class="dv">5</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">"darkgreen"</span>)</span>
<span id="cb14-30"><a href="#cb14-30"></a></span>
<span id="cb14-31"><a href="#cb14-31"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(g.plot[lzero.bound<span class="op">$</span>upper],hpd.sens[<span class="dv">1</span>,][lzero.bound<span class="op">$</span>upper], <span class="dt">lty =</span> <span class="dv">5</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">"red"</span>)</span>
<span id="cb14-32"><a href="#cb14-32"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/lines">lines</a></span>(g.plot[<span class="op">-</span>lzero.bound<span class="op">$</span>upper],hpd.sens[<span class="dv">1</span>,][<span class="op">-</span>lzero.bound<span class="op">$</span>upper], <span class="dt">lty =</span> <span class="dv">5</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col=</span> <span class="st">"darkgreen"</span>)</span>
<span id="cb14-33"><a href="#cb14-33"></a></span>
<span id="cb14-34"><a href="#cb14-34"></a><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/legend">legend</a></span>(<span class="st">"topleft"</span>, <span class="dt">legend =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Expected Main Effect"</span>, <span class="st">"95% Bounds"</span>, <span class="st">"Net Revenue &lt; $0"</span>, <span class="st">"Net Revenue &gt; $0"</span>), <span class="dt">col =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"black"</span>,<span class="st">"black"</span>,<span class="st">"red"</span>, <span class="st">"darkgreen"</span>), <span class="dt">lty =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">lwd =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">bg =</span> <span class="st">"white"</span>)</span></code></pre></div>
<p><img src="../../../R%20Packages/BayesMassBal/BayesMassBal/man/figures/README-maineffplot-1.png" width="100%"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/skoermer/BayesMassBal">https://​github.com/​skoermer/​BayesMassBal</a>
</li>
<li>Report a bug at <br><a href="https://github.com/skoermer/BayesMassBal/issues">https://​github.com/​skoermer/​BayesMassBal/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Scott Koermer <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

      <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/skoermer/BayesMassBal"><img src="https://travis-ci.org/skoermer/BayesMassBal.svg?branch=master" alt="Travis build status"></a></li>
<li><a href="https://ci.appveyor.com/project/skoermer/BayesMassBal"><img src="https://ci.appveyor.com/api/projects/status/github/skoermer/BayesMassBal?branch=master&amp;svg=true" alt="AppVeyor build status"></a></li>
<li><a href="https://codecov.io/gh/skoermer/BayesMassBal?branch=master"><img src="https://codecov.io/gh/skoermer/BayesMassBal/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Scott Koermer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
